<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pr√°ctica de Hiragana y Katakana</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-blue-500 to-purple-600 min-h-screen flex items-center justify-center">
  <div class="bg-white p-8 rounded-lg shadow-lg w-96 text-center">
    <h1 class="text-2xl font-bold text-gray-800 mb-4">üìñ Aprende Hiragana y Katakana</h1>
    <p class="text-lg text-gray-600 mb-2">Nivel: <span id="level" class="font-bold">1</span></p>
    <p class="text-lg text-gray-600 mb-6">Puntaje: <span id="score" class="font-bold">0</span></p>

    <!-- Car√°cter japon√©s -->
    <div class="text-6xl font-bold text-purple-700 mb-4 animate-bounce" id="currentChar">
      „ÅÇ
    </div>

    <!-- Input para responder -->
    <input 
      type="text" 
      placeholder="Escribe la lectura..." 
      class="border-2 border-gray-300 rounded-lg w-full p-3 text-lg focus:outline-none focus:ring-2 focus:ring-purple-500"
      id="answerInput"
    />

    <!-- Botones -->
    <div class="mt-6 space-y-3">
      <button 
        class="bg-purple-500 text-white w-full py-3 rounded-lg hover:bg-purple-600 transition"
        onclick="checkAnswer()"
      >
        Comprobar
      </button>
      <button 
        class="bg-gray-300 text-gray-700 w-full py-3 rounded-lg hover:bg-gray-400 transition"
        onclick="nextQuestion()"
      >
        Siguiente
      </button>
    </div>

    <!-- Resultado -->
    <div id="result" class="mt-6 text-lg font-bold"></div>

    <!-- Nivel Up Notification -->
    <div id="levelUp" class="hidden text-xl font-bold text-yellow-500 mt-4 animate-pulse">
      üéâ ¬°Subiste de nivel! üéâ
    </div>
  </div>

  <script>
    // Lista de caracteres (hiragana + katakana)
    const characters = [
      { char: "„ÅÇ", answer: "a" }, { char: "„ÅÑ", answer: "i" }, { char: "„ÅÜ", answer: "u" },
      { char: "„Åà", answer: "e" }, { char: "„Åä", answer: "o" },
      { char: "„Åã", answer: "ka" }, { char: "„Åç", answer: "ki" }, { char: "„Åè", answer: "ku" },
      { char: "„Åë", answer: "ke" }, { char: "„Åì", answer: "ko" },
      { char: "„Åï", answer: "sa" }, { char: "„Åó", answer: "shi" }, { char: "„Åô", answer: "su" },
      { char: "„Åõ", answer: "se" }, { char: "„Åù", answer: "so" },
      { char: "„Åü", answer: "ta" }, { char: "„Å°", answer: "chi" }, { char: "„Å§", answer: "tsu" },
      { char: "„Å¶", answer: "te" }, { char: "„Å®", answer: "to" },
      { char: "„Å™", answer: "na" }, { char: "„Å´", answer: "ni" }, { char: "„Å¨", answer: "nu" },
      { char: "„Å≠", answer: "ne" }, { char: "„ÅÆ", answer: "no" },
      { char: "„ÅØ", answer: "ha" }, { char: "„Å≤", answer: "hi" }, { char: "„Åµ", answer: "fu" },
      { char: "„Å∏", answer: "he" }, { char: "„Åª", answer: "ho" },
      { char: "„Åæ", answer: "ma" }, { char: "„Åø", answer: "mi" }, { char: "„ÇÄ", answer: "mu" },
      { char: "„ÇÅ", answer: "me" }, { char: "„ÇÇ", answer: "mo" },
      { char: "„ÇÑ", answer: "ya" }, { char: "„ÇÜ", answer: "yu" }, { char: "„Çà", answer: "yo" },
      { char: "„Çâ", answer: "ra" }, { char: "„Çä", answer: "ri" }, { char: "„Çã", answer: "ru" },
      { char: "„Çå", answer: "re" }, { char: "„Çç", answer: "ro" },
      { char: "„Çè", answer: "wa" }, { char: "„Çí", answer: "wo" }, { char: "„Çì", answer: "n" },
      { char: "„Ç¢", answer: "a" }, { char: "„Ç§", answer: "i" }, { char: "„Ç¶", answer: "u" },
      { char: "„Ç®", answer: "e" }, { char: "„Ç™", answer: "o" },
      { char: "„Ç´", answer: "ka" }, { char: "„Ç≠", answer: "ki" }, { char: "„ÇØ", answer: "ku" },
      { char: "„Ç±", answer: "ke" }, { char: "„Ç≥", answer: "ko" },
      { char: "„Çµ", answer: "sa" }, { char: "„Ç∑", answer: "shi" }, { char: "„Çπ", answer: "su" },
      { char: "„Çª", answer: "se" }, { char: "„ÇΩ", answer: "so" },
      { char: "„Çø", answer: "ta" }, { char: "„ÉÅ", answer: "chi" }, { char: "„ÉÑ", answer: "tsu" },
      { char: "„ÉÜ", answer: "te" }, { char: "„Éà", answer: "to" },
      { char: "„Éä", answer: "na" }, { char: "„Éã", answer: "ni" }, { char: "„Éå", answer: "nu" },
      { char: "„Éç", answer: "ne" }, { char: "„Éé", answer: "no" },
      { char: "„Éè", answer: "ha" }, { char: "„Éí", answer: "hi" }, { char: "„Éï", answer: "fu" },
      { char: "„Éò", answer: "he" }, { char: "„Éõ", answer: "ho" },
      { char: "„Éû", answer: "ma" }, { char: "„Éü", answer: "mi" }, { char: "„É†", answer: "mu" },
      { char: "„É°", answer: "me" }, { char: "„É¢", answer: "mo" },
      { char: "„É§", answer: "ya" }, { char: "„É¶", answer: "yu" }, { char: "„É®", answer: "yo" },
      { char: "„É©", answer: "ra" }, { char: "„É™", answer: "ri" }, { char: "„É´", answer: "ru" },
      { char: "„É¨", answer: "re" }, { char: "„É≠", answer: "ro" },
      { char: "„ÉØ", answer: "wa" }, { char: "„É≤", answer: "wo" }, { char: "„É≥", answer: "n" },
    ];

    let currentIndex = 0;
    let score = 0;
    let level = 1;

    async function checkAnswer() {
      const userAnswer = document.getElementById("answerInput").value.trim().toLowerCase();
      const result = document.getElementById("result");

      if (userAnswer === characters[currentIndex].answer) {
        score++;
        result.textContent = "‚úÖ ¬°Correcto!";
        result.classList.add("text-green-600");
        result.classList.remove("text-red-600");

        // Nivel Up cada 10 puntos
        if (score % 10 === 0) {
          level++;
          document.getElementById("level").textContent = level;
          const levelUp = document.getElementById("levelUp");
          levelUp.classList.remove("hidden");
          setTimeout(() => levelUp.classList.add("hidden"), 2000);
        }
      } else {
        result.textContent = `‚ùå Incorrecto. La respuesta es "${characters[currentIndex].answer}".`;
        result.classList.add("text-red-600");
        result.classList.remove("text-green-600");
      }

      document.getElementById("score").textContent = score;

      // Enviar los datos a la funci√≥n serverless
      try {
        const response = await fetch('/api/submit', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            score, 
            level, 
            userAnswer, // Enviamos la respuesta escrita
            correctAnswer: characters[currentIndex].answer, // Enviamos la respuesta correcta
          }),
        });
        const data = await response.json();
        console.log(data.message); // Confirmaci√≥n de que los datos fueron recibidos
      } catch (error) {
        console.error('Error al enviar los datos:', error);
      }
    }

    function nextQuestion() {
      currentIndex = Math.floor(Math.random() * characters.length);
      document.getElementById("answerInput").value = "";
      document.getElementById("result").textContent = "";
      document.getElementById("currentChar").textContent = characters[currentIndex].char;
    }
  </script>
</body>
</html>
